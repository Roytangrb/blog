<!doctype html><html lang=en><meta charset=utf-8><meta name=generator content="Hugo 0.79.1"><meta name=viewport content="width=device-width,initial-scale=1,viewport-fit=cover"><meta name=color-scheme content="light dark"><meta name=supported-color-schemes content="light dark"><title>Blogging with Hugo & gh-pages&nbsp;&ndash;&nbsp;Markdown Porn</title><link rel=stylesheet href=/blog/css/core.min.379150549074550444bc36929881ff8b36f20fd82548628e5021fe23480c518b9fc9be2672c6d3d70f434788d489364c.css integrity=sha384-N5FQVJB0VQREvDaSmIH/izbyD9glSGKOUCH+I0gMUYufyb4mcsbT1w9DR4jUiTZM><meta name=twitter:card content="summary"><meta name=twitter:title content="Blogging with Hugo & gh-pages"><meta name=description content="Tutorial on how to create a blog using Hugo static site generator and host it on Github with gh-pages and Github Actions"><meta itemprop=description content="Tutorial on how to create a blog using Hugo static site generator and host it on Github with gh-pages and Github Actions"><meta property="og:description" content="Tutorial on how to create a blog using Hugo static site generator and host it on Github with gh-pages and Github Actions"><meta name=twitter:description content="Tutorial on how to create a blog using Hugo static site generator and host it on Github with gh-pages and Github Actions"><body><section id=header><div class="header wrap"><span class="header left-side"><a class="site home" href=/blog/><span class="site name">Markdown Porn</span></a></span>
<span class="header right-side"><div class="nav wrap"><nav class=nav><a class="nav item" href=/blog/categories/>Categories</a><a class="nav item" href=/blog/tags/>Tags</a><a class="nav item" href=https://github%2ecom/Roytangrb/ target=_blank>Github</a></nav></div></span></div></section><section id=content><div class=article-container><section class="article header"><h1 class="article title">Blogging with Hugo & gh-pages</h1><p class="article date">Saturday, October 17, 2020</p></section><article class="article markdown-body"><p>Having been working as a software developer for over a year, I finally started this blog for the good habit of taking notes along the way of learning.</p><h3 id=goals>Goals</h3><p>This initial post will walk through the steps of:</p><ol><li>Setting up Hugo for local development and post drafting</li><li>Hosting your source code on Github, and your static site generated on the <code>gh-pages</code> branch</li><li>Use Github Actions to automate your Hugo build and deployment. Surprisingly, it&rsquo;s easy, fast and free!</li></ol><h4 id=getting-started>Getting started</h4><p>To get started, first install Hugo cli with Homebrew:</p><div class=highlight><pre class=chroma><code class=language-bash data-lang=bash>brew install hugo
</code></pre></div><p>To check if the installation succeeds, run:</p><div class=highlight><pre class=chroma><code class=language-bash data-lang=bash>hugo version
</code></pre></div><h4 id=hugo-setup>Hugo setup</h4><p>Create a new Hugo site project by running:</p><div class=highlight><pre class=chroma><code class=language-bash data-lang=bash>hugo new site <span class=o>[</span>path/to/&lt;name-of-your-site&gt;<span class=o>]</span>
</code></pre></div><p>A new directory will be created for you.</p><p>You might be using themes for you blog. You may browse the available options on the <a href=https://themes.gohugo.io/ target=_blank>theme list</a>. I personally chose <a href=https://github.com/cntrump/hugo-notepadium target=_blank>Notepadium</a>.</p><p>Hugo themes are usually added to your project and managed as a <a href=https://www.atlassian.com/git/tutorials/git-submodule target=_blank>git submodule</a>, which means it&rsquo;s not really your source code but the vendor dependency is kept track of.</p><div class=highlight><pre class=chroma><code class=language-bash data-lang=bash>git submodule add https://github.com/cntrump/hugo-notepadium.git themes/hugo-notepadium
</code></pre></div><p>The theme is now installed under the <code>themes/</code> directory. Noted that a <code>.gitmodules</code> file is generated. Next time when you clone your project on a different computer, the theme (submodule) will not be pull by default. You need to run either</p><ul><li><code>git clone --recursive &lt;your-git-repo.git></code> or</li><li><code>git clone &lt;your-git-repo.git></code> & <code>git submodule init</code> & <code>git submodule update</code></li></ul><p>Run the development server by using:</p><div class=highlight><pre class=chroma><code class=language-bash data-lang=bash>hugo server -D <span class=c1># -D makes the server render draft content</span>
</code></pre></div><p>Generate you site using the build command: <code>hugo</code>. You might want to modify <code>.gitignore</code> to ignore the output directory <code>public/</code> because we could use Github Actions to automate the build-and-deploy pipeline.</p><h4 id=host-things-on-github>Host things on github</h4><p>Now the project is all setup, we can start writing, styling and play with the markdown porn. We can just push our local git repo to Github. Same old flow of using gh-pages, create a empty git and push the local git up.</p><p>Github has changed the default branch from <code>master</code> to <code>main</code> :). We will use <code>main</code> branch as the release branch to trigger deployment later.</p><p>Our goal is to push the generated output i.e the <code>public/</code> folder to gh-pages. From there Github will host all the html/css/js for us. We can take the simple approach by not to ignore the output from git, and push the <code>public/</code> as the git subtree to the <code>origin/gh-pages</code> branch. We will need to re-build manually and type out this push command every time:</p><div class=highlight><pre class=chroma><code class=language-bash data-lang=bash><span class=c1># Deploying a subfolder to GitHub Pages</span>
<span class=c1># https://gist.github.com/cobyism/4730490</span>
git subtree push --prefix public origin gh-pages
</code></pre></div><p>This will do, but we want to automate things.</p><h4 id=using-github-actions>Using Github Actions</h4><p>The CI/CD pipeline of our blog is just as simple as adding a new workflow on Github (you can find it in the <code>Actions</code> tab of you repo).</p><p>Replace the <code>.yml</code> job config as follow, you blog site will be updated on new code push to <code>main</code> branch</p><div class=highlight><pre class=chroma><code class=language-yml data-lang=yml><span class=nt>on</span><span class=p>:</span><span class=w>
</span><span class=w>  </span><span class=nt>push</span><span class=p>:</span><span class=w>
</span><span class=w>    </span><span class=nt>branches</span><span class=p>:</span><span class=w>
</span><span class=w>      </span>- <span class=l>main </span><span class=w> </span><span class=c># Set a branch to trigger deploy</span><span class=w>
</span><span class=w>
</span><span class=w></span><span class=nt>jobs</span><span class=p>:</span><span class=w>
</span><span class=w>  </span><span class=nt>deploy</span><span class=p>:</span><span class=w>
</span><span class=w>    </span><span class=nt>runs-on</span><span class=p>:</span><span class=w> </span><span class=l>ubuntu-latest</span><span class=w>
</span><span class=w>    </span><span class=nt>steps</span><span class=p>:</span><span class=w>
</span><span class=w>      </span>- <span class=nt>uses</span><span class=p>:</span><span class=w> </span><span class=l>actions/checkout@v2</span><span class=w>
</span><span class=w>        </span><span class=nt>with</span><span class=p>:</span><span class=w>
</span><span class=w>          </span><span class=nt>submodules</span><span class=p>:</span><span class=w> </span><span class=kc>true</span><span class=w>  </span><span class=c># Fetch Hugo themes (true OR recursive)</span><span class=w>
</span><span class=w>          </span><span class=nt>fetch-depth</span><span class=p>:</span><span class=w> </span><span class=m>0</span><span class=w>    </span><span class=c># Fetch all history for .GitInfo and .Lastmod</span><span class=w>
</span><span class=w>
</span><span class=w>      </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>Setup Hugo</span><span class=w>
</span><span class=w>        </span><span class=nt>uses</span><span class=p>:</span><span class=w> </span><span class=l>peaceiris/actions-hugo@v2</span><span class=w>
</span><span class=w>        </span><span class=nt>with</span><span class=p>:</span><span class=w>
</span><span class=w>          </span><span class=nt>hugo-version</span><span class=p>:</span><span class=w> </span><span class=s1>&#39;0.75.1&#39;</span><span class=w>
</span><span class=w>          </span><span class=c># extended: true</span><span class=w>
</span><span class=w>
</span><span class=w>      </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>Build</span><span class=w>
</span><span class=w>        </span><span class=nt>run</span><span class=p>:</span><span class=w> </span><span class=l>hugo --minify</span><span class=w>
</span><span class=w>
</span><span class=w>      </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>Deploy</span><span class=w>
</span><span class=w>        </span><span class=nt>uses</span><span class=p>:</span><span class=w> </span><span class=l>peaceiris/actions-gh-pages@v3</span><span class=w>
</span><span class=w>        </span><span class=nt>with</span><span class=p>:</span><span class=w>
</span><span class=w>          </span><span class=nt>github_token</span><span class=p>:</span><span class=w> </span><span class=l>${{ secrets.GITHUB_TOKEN }}</span><span class=w>
</span><span class=w>          </span><span class=nt>publish_dir</span><span class=p>:</span><span class=w> </span><span class=l>./public</span><span class=w>
</span></code></pre></div><p>If you need to customize the build/deploy task, find the actions' documentation <a href=https://github.com/peaceiris/actions-hugo target=_blank>here</a>.</p><h4 id=summary>Summary</h4><p>I have been studying the golang a bit recently and learned that Hugo might be the fastest static site generator. I shall have more insights if my content grows, but it seems very promising to me so far.</p><p>The Github Actions are nice, especially for people already familiar with Github. The usage and interface are pretty similar to Azure DevOps I am using for work.</p><p>The biggest inspiration from setting up this project is the use of git submodule. At work, my team uses NPM/YARN to manage different SDK (node_modules) for a react-native project. Each business unit or vendor feature is cut into a separate git. Different components are assembled as node_modules dependencies in the base app. It took me a whole day just trying to build the app, so it did for other newcomers. It causes some issues:</p><ul><li>Messy dependencies (not knowing which node_modules the code is importing from), probably caused by the peer dependencies config</li><li>Bad collaboration git flow, people have different project setup, some modify component&rsquo;s code in the <code>node_modules</code> folder, some use different js bundler config to maintain a flat folder structure. Different project structures actually affect how node_modules are resolved</li><li>Yarn and NPM fail to pulling the latest commits from git repo, the app just won&rsquo;t build the next day if you pull somebody elses' commits</li></ul><p>Git submodule seems to be an alternative approach to study on for a integration project with loads of parties/sub-project/vendor modules and features.</p><p>The source code for my blog could be found in this <a href=https://github.com/Roytangrb/blog/tree/main target=_blank>repo</a>.</p></article><section class="article labels"><a class=category href=/blog/categories/web/>Web</a><a class=tag href=/blog/tags/hugo/>Hugo</a><a class=tag href=/blog/tags/github-actions/>Github Actions</a></section></div><div class="article bottom"><section class="article navigation"><p><a class=link href=/blog/posts/micro-svc-dev-minikube-skaffold/><span class="iconfont icon-article"></span>Micro-services development with Minikube and Skaffold</a></p></section></div></section><section id=footer><div class=footer-wrap><p class=copyright>©2020 Roy Tang</p><p class=powerby><span>Powered by </span><a href=https://gohugo.io target=_blank>Hugo</a><span> and the </span><a href=https://themes.gohugo.io/hugo-notepadium/ target=_blank>Notepadium</a></p></div></section><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;ga('create','UA-110375294-1','auto');ga('send','pageview');}</script><script async src=https://www.google-analytics.com/analytics.js></script></body></html>